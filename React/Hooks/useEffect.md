# useEffect

컴포넌트가 렌더링 될 때마다 특정 작업을 실행할 수 있도록 하는 Hook

아래의 것들을 처리할 수 있다

- 컴포넌트가 마운트 됐을 때 (처음 나타났을 때)
- 컴포넌트가 언마운트 됐을 때 (사라질 때)
- 업데이트 될 때 (특정 props가 바뀔 때)


## 구성요소

- 함수 - 첫번째 파라미터
- deps - 두번째 파라미터 (의존값이 들어있는 배열)
- cleanup 함수 - 반환되는 함수

```jsx
useEffect(() => {
  console.log("first parameter");
  return () => {
    console.log("cleanup function");
  }
}, []);//deps array
```

## 동작

### deps 배열이 비워져 있을 때

1. 컴포넌트가 처음 나타날때에만 useEffect에 등록한 함수가 호출된다
2. 컴포넌트가 사라질 때 cleanup 함수가 호출된다

### deps에 특정 값이 있을 때

1. 컴포넌트가 처음 마운트 될 때에 호출이 된다
2. 지정한 값(deps)의 값이 바뀔 때 호출이 된다
3. 컴포넌트가 언마운트 될 때 호출이 된다
4. 값이 바뀌기 직전 호출된다

### deps 파라미터를 생략 했을 때

컴포넌트가 리렌더링 될 때마다 호출이 된다

## 마운트 / 언마운트

## 마운트 시에 하는 작업들

- props 로 받은 값을 컴포넌트의 로컬 상태로 설정
- 외부 API 요청 (REST API 등)
- 라이브러리 사용 (D3, Video.js 등...)
- setInterval 을 통한 반복작업 혹은 setTimeout 을 통한 작업 예약

## 언마운트 시에 하는 작업들

- setInterval, setTimeout을 사용하여 등록한 작업들 clear 하기 (clearInterval, clearTimeout)
- 라이브러리 인스턴스 제거

## 참고

- 컴포넌트는 기본적으로 부모 컴포넌트가 리렌더링되면 자식 컴포넌트 또한 리렌더링이 된다 (바뀐 내용이 없더라도)
- 실제 DOM에 반영되는건 바뀐 내용이 있는 컴포넌트에만 해당한다
- 가상(Virtual) DOM에는 모든걸 다 렌더링하고 있다
